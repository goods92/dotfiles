(window.webpackJsonp=window.webpackJsonp||[]).push([[8],{jaWL:function(n,t,l){"use strict";l.r(t),l.d(t,"LogsModuleNgFactory",(function(){return I}));var e=l("8Y7J");class o{}var s=l("pMnS"),a=l("SVse"),i=l("mrSG"),r=l("XNiG"),u=l("Iab2"),c=l("Vurf"),d=l("HyEY"),m=l("znvU"),p=l("/5R1");class g{constructor(n,t,l,e,o,s){this.$auth=n,this.$api=t,this.$log=l,this.$toastr=e,this.$translate=o,this.$modal=s,this.resizeEvent=new r.a}ngOnInit(){window.document.querySelector("body").classList.add("bg-black"),this.$log.startTerminal(this.termTarget,{},this.resizeEvent)}onWindowResize(n){this.resizeEvent.next()}ngOnDestroy(){window.document.querySelector("body").classList.remove("bg-black"),this.$log.destroyTerminal()}downloadLogFile(){const n=this.$modal.open(p.a);n.componentInstance.title=this.$translate.instant("logs.title_download_log_file"),n.componentInstance.message=this.$translate.instant("logs.message_download_warning"),n.componentInstance.confirmButtonLabel=this.$translate.instant("logs.label_download"),n.result.then(()=>{this.$api.get("/platform-tools/hb-service/log/download",{observe:"response",responseType:"blob"}).subscribe(n=>{Object(u.saveAs)(n.body,"homebridge.log.txt")},n=>Object(i.a)(this,void 0,void 0,(function*(){let t;try{t=JSON.parse(yield n.error.text()).message}catch(l){}this.$toastr.error(t||"Failed to download log file",this.$translate.instant("toast.title_error"))})))}).catch(()=>{})}truncateLogFile(){const n=this.$modal.open(p.a);n.componentInstance.title=this.$translate.instant("logs.title_truncate_log_file"),n.componentInstance.message=this.$translate.instant("logs.message_truncate_log_warning"),n.componentInstance.confirmButtonLabel=this.$translate.instant("logs.label_truncate"),n.result.then(()=>{this.$api.put("/platform-tools/hb-service/log/truncate",{}).subscribe(n=>{this.$toastr.success(this.$translate.instant("logs.message_log_file_truncated"),this.$translate.instant("toast.title_success")),this.$log.term.clear()},n=>{this.$toastr.error(n.error.message||"Failed to truncate log file",this.$translate.instant("toast.title_error"))})}).catch(()=>{})}}var b=l("EApP"),h=l("TSSN"),f=l("G0yt"),v=e["\u0275crt"]({encapsulation:0,styles:[[".log-buttons[_ngcontent-%COMP%]{position:fixed;top:80px;right:10px;z-index:1000}.log-buttons[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{opacity:.4;transition:opacity .2s ease-in}.log-buttons[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:active, .log-buttons[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:hover{opacity:1}"]],data:{}});function w(n){return e["\u0275vid"](0,[(n()(),e["\u0275eld"](0,0,null,null,4,"div",[["class","log-buttons"]],null,null,null,null,null)),(n()(),e["\u0275eld"](1,0,null,null,1,"button",[["class","btn btn-primary"]],null,[[null,"click"]],(function(n,t,l){var e=!0;return"click"===t&&(e=!1!==n.component.downloadLogFile()&&e),e}),null,null)),(n()(),e["\u0275eld"](2,0,null,null,0,"i",[["class","fas fa-download"]],null,null,null,null,null)),(n()(),e["\u0275eld"](3,0,null,null,1,"button",[["class","btn btn-danger"]],null,[[null,"click"]],(function(n,t,l){var e=!0;return"click"===t&&(e=!1!==n.component.truncateLogFile()&&e),e}),null,null)),(n()(),e["\u0275eld"](4,0,null,null,0,"i",[["class","fas fa-trash-alt"]],null,null,null,null,null))],null,null)}function $(n){return e["\u0275vid"](0,[e["\u0275qud"](402653184,1,{termTarget:0}),(n()(),e["\u0275and"](16777216,null,null,1,null,w)),e["\u0275did"](2,16384,null,0,a.NgIf,[e.ViewContainerRef,e.TemplateRef],{ngIf:[0,"ngIf"]},null),(n()(),e["\u0275eld"](3,0,null,null,1,"div",[["class","flex-column d-flex align-items-stretch h-100"]],null,null,null,null,null)),(n()(),e["\u0275eld"](4,0,[[1,0],["logoutput",1]],null,0,"div",[["class","terminal align-self-end w-100 h-100 mb-1"],["id","log-output"]],null,null,null,null,null))],(function(n,t){n(t,2,0,t.component.$auth.env.serviceMode)}),null)}function _(n){return e["\u0275vid"](0,[(n()(),e["\u0275eld"](0,0,null,null,1,"app-logs",[],null,[["window","resize"]],(function(n,t,l){var o=!0;return"window:resize"===t&&(o=!1!==e["\u0275nov"](n,1).onWindowResize(l)&&o),o}),$,v)),e["\u0275did"](1,245760,null,0,g,[c.a,d.a,m.a,b.j,h.m,f.x],null,null)],(function(n,t){n(t,1,0)}),null)}var y=e["\u0275ccf"]("app-logs",g,_,{},{},[]),L=l("9AJC"),C=l("s7LF"),z=l("iInd");class O{}var I=e["\u0275cmf"](o,[],(function(n){return e["\u0275mod"]([e["\u0275mpd"](512,e.ComponentFactoryResolver,e["\u0275CodegenComponentFactoryResolver"],[[8,[s.a,y,L.a,L.b,L.j,L.k,L.g,L.h,L.i]],[3,e.ComponentFactoryResolver],e.NgModuleRef]),e["\u0275mpd"](4608,a.NgLocalization,a.NgLocaleLocalization,[e.LOCALE_ID]),e["\u0275mpd"](4608,C.z,C.z,[]),e["\u0275mpd"](4608,f.x,f.x,[e.ComponentFactoryResolver,e.Injector,f.vb,f.y]),e["\u0275mpd"](1073742336,a.CommonModule,a.CommonModule,[]),e["\u0275mpd"](1073742336,z.p,z.p,[[2,z.u],[2,z.l]]),e["\u0275mpd"](1073742336,O,O,[]),e["\u0275mpd"](1073742336,f.c,f.c,[]),e["\u0275mpd"](1073742336,f.g,f.g,[]),e["\u0275mpd"](1073742336,f.i,f.i,[]),e["\u0275mpd"](1073742336,f.m,f.m,[]),e["\u0275mpd"](1073742336,f.n,f.n,[]),e["\u0275mpd"](1073742336,C.y,C.y,[]),e["\u0275mpd"](1073742336,C.l,C.l,[]),e["\u0275mpd"](1073742336,f.t,f.t,[]),e["\u0275mpd"](1073742336,f.v,f.v,[]),e["\u0275mpd"](1073742336,f.z,f.z,[]),e["\u0275mpd"](1073742336,f.B,f.B,[]),e["\u0275mpd"](1073742336,f.G,f.G,[]),e["\u0275mpd"](1073742336,f.L,f.L,[]),e["\u0275mpd"](1073742336,f.O,f.O,[]),e["\u0275mpd"](1073742336,f.T,f.T,[]),e["\u0275mpd"](1073742336,f.bb,f.bb,[]),e["\u0275mpd"](1073742336,f.eb,f.eb,[]),e["\u0275mpd"](1073742336,f.hb,f.hb,[]),e["\u0275mpd"](1073742336,f.kb,f.kb,[]),e["\u0275mpd"](1073742336,f.W,f.W,[]),e["\u0275mpd"](1073742336,f.A,f.A,[]),e["\u0275mpd"](1073742336,o,o,[]),e["\u0275mpd"](1024,z.j,(function(){return[[{path:"",component:g}]]}),[])])}))}}]);